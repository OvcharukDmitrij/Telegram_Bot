## Телеграм бот 
#### для отправки сообщений пользователям.

### Возможности

1. Бот позволяет отправлять сообщения из списка сообщений (далее - СС) пользователям, запуcтившим его.
СС хранится в БД (таблица `Message`).  
Для быстрого добавления СС в БД реализован скрипт `read_csv.py`,
который позволяет внести в БД все сообщения из таблицы `/scr/data/Data.csv`.
Для примера заполнения файла `Data.csv` в директории `/scr/data/` размещен файл `Data_example.csv`.  
Для заполнения БД сообщениями из СС необходимо выполнить в терминале команду `python read_csv.py`, находясь в директории `/scr`.
2. Каждый пользователь, запустивший бота, сохраняется в БД (таблица `Users`). 
С помощью бота возможна однократная отправка сообщения всем пользователям из БД. Для этого необходимо выполнить в терминале команду `python send_message.py`, находясь в директории `/scr`.
Текст сообщения, планируемый к отправке пользователям, необходимо присвоить переменной `text` файла `send_message.py`
3. Функционал бота позволяет ограничить получение сообщения пользователем при нажатии кнопки **далее**, если дата доступности сообщения
(поле `opening_date` таблицы `Message`) меньше текущей даты. 


### Установка

1. Клонируйте репозиторий `https://github.com/OvcharukDmitrij/Telegram_Bot.git`.
2. Создайте виртуальное окружение и установите зависимости из файла `requirements.txt`.
3. Заполните таблицу `scr/data/Data.csv` своими данными и внесите их в БД при помощи команды `python read_csv.py`.
При первом выполнении вышеуказанного скрипта в директории `/scr` автоматически создается БД `sqlite.db`.

!!! **ВНИМАНИЕ** При использовании команды `python read_csv.py` все имеющиеся данные в таблице `Message` будут заменены на новые.
4. Создайте бота в Телеграм с помощью BotFather https://t.me/BotFather.
5. Заполните файл с переменными окружения .env (для примера в репозитории размещен файл .env.example):  
5.1. В переменной `TOKEN` укажите токен созданного в BotFather бота.  
5.2. В переменной `OWNER_ID` укажите id пользователя Telegram, которому придет сообщение, в случае остановки бота.
6. Запустите бота выполнив в терминале команду `python bot.py`, находясь в директории `/scr`.


## Стек

1. Python и библиотека Python-telegram-bot
2. SQLAlchemy
3. SQLite3
4. Jinja2

## Автор

Овчарук Дмитрий
